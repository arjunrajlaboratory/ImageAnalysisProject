# SAM2 Refiner

**Type:** Annotation Worker  
**Annotation Shape:** `polygon`  
**Interface Category:** SAM2  
**GPU Support:** Yes (NVIDIA CUDA)  

## Description

This tool uses the SAM2 model to refine existing annotations. It takes existing annotations, uses them as prompts (via bounding boxes), and generates refined segmentation masks that better match the underlying image data.

## Interface Parameters

| Parameter | Type | Required | Default | Range / Options | Description |
|-----------|------|:--------:|---------|-----------------|-------------|
| **Batch XY** | `text` |  | -- | -- | Enter the XY positions you want to process |
| **Batch Z** | `text` |  | -- | -- | Enter the Z positions you want to process |
| **Batch Time** | `text` |  | -- | -- | Enter the Time positions you want to process |
| **Tag of objects to refine** | `tags` |  | -- | -- |  |
| **Model** *(runtime)* | `select` |  | -- | _runtime_ | The SAM2 model to use for refinement. Larger models may give slightly better results, but are slower and use more memory. |
| **Delete original annotations** | `checkbox` |  | False | -- | If checked, the original annotations will be deleted after refinement. |
| **Padding** | `number` |  | 0 | -20 - 20 Pixels | Padding will expand (or, if negative, contract) the polygon boundary. |
| **Smoothing** | `number` |  | 0.7 | 0 - 3 | Smoothing is used to simplify the polygons; a value of 0.7 is a good default. |

> **(runtime)** = option list is fetched at runtime (e.g. available trained models).

## Files

| File | Description |
|------|-------------|
| `entrypoint.py` | Main worker logic -- `interface()` defines the UI, `compute()` runs the analysis |
| `Dockerfile` | Docker build configuration (x86_64 / production) |
| `Dockerfile_M1` | ARM64 / Apple Silicon Docker configuration |
| `environment.yml` | Conda environment dependencies |

## Building

```bash
./build_workers.sh sam2_refine
```

---
_This file is auto-generated by `generate_worker_docs.py`. To update, edit `entrypoint.py` and re-run the generator, or open a PR -- the Claude Code hook regenerates docs automatically._
