# Cellpose retrain

**Type:** Annotation Worker  
**Annotation Shape:** `polygon`  
**Interface Category:** Cellpose  
**GPU Support:** Yes (NVIDIA CUDA)  

## Description

This tool trains a Cellpose model using user-corrected annotations. Learn more

## Interface Parameters

| Parameter | Type | Required | Default | Range / Options | Description |
|-----------|------|:--------:|---------|-----------------|-------------|
| **Base Model** *(runtime)* | `select` |  | cyto3 | _runtime_ | This model is the one used as a base for training. cyto3 is the most accurate for cells, whereas nuclei is best for finding nuc... |
| **Nuclear Model?** | `checkbox` |  | False | -- | If you are training a nuclear model, check this box. |
| **Output Model Name** | `text` |  | -- | -- | The name of the retrained model (to be saved to your .cellpose/models folder). |
| **Primary Channel** | `channel` |  | -- | -- | The channel to use for the primary segmentation. If you are segmenting cytoplasm, put your cytoplasm channel here. If you are s... |
| **Secondary Channel** | `channel` |  | none | -- | The channel to use for the secondary segmentation. If you are segmenting cytoplasm, put your nuclei channel here. If you are se... |
| **Training Tag** | `tags` |  | -- | -- | Train the model on objects that have this tag. |
| **Training Region** | `tags` |  | -- | -- | These objects define the regions that the training will be performed on. If you do not select any objects, the training will be... |
| **Learning Rate** | `number` |  | 0.01 | 0.0001 - 0.5 | The learning rate for the training. 0.01 is a good starting point. |
| **Epochs** | `number` |  | 1000 | 100 - 2000 | The number of epochs to train the model for. 1000 is a good starting point. |
| **Weight Decay** | `number` |  | 0.0001 | 0 - 0.01 | The weight decay for the training. |

> **(runtime)** = option list is fetched at runtime (e.g. available trained models).

## Files

| File | Description |
|------|-------------|
| `entrypoint.py` | Main worker logic -- `interface()` defines the UI, `compute()` runs the analysis |
| `Dockerfile` | Docker build configuration (x86_64 / production) |
| `environment.yml` | Conda environment dependencies |

## Building

```bash
./build_workers.sh cellpose_train
```

---
_This file is auto-generated by `generate_worker_docs.py`. To update, edit `entrypoint.py` and re-run the generator, or open a PR -- the Claude Code hook regenerates docs automatically._
